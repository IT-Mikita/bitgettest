<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Bitget Entry</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://unpkg.com/dragula/dist/dragula.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/dragula/dist/dragula.min.css">
    <script>
        function setThemeClass() {
            document.documentElement.className = Telegram.WebApp.colorScheme;
        }
        Telegram.WebApp.onEvent('themeChanged', setThemeClass);
        setThemeClass();
    </script>
    <style>
        body {
            margin: 0;
            padding: 0;
            color: var(--tg-theme-text-color);
            background: var(--tg-theme-secondary-bg-color);
            overflow: hidden;
            font-family: Arial, sans-serif;

        }
        .scrollable_content::-webkit-scrollbar {
            display: none;
            width: 0;  /* Убираем вертикальный скролл */
            height: 0; /* Убираем горизонтальный скролл */
        }
        .scrollable_content {
            -ms-overflow-style: none;  /* IE и Edge */
            scrollbar-width: none;  /* Firefox */
            max-height: 100vh;
            overflow-y: auto;
            margin: 0;
            padding-top: 80px;
            box-sizing: border-box;
        }
        header {
            max-height: 55px;
            display: flex;
            padding: 10px 20px 10px 20px;
            background: var(--tg-theme-bg-color);
            color: var(--tg-theme-text-color);
            justify-content: space-between;
            align-items: center;
            border-bottom-left-radius: 15px;
            border-bottom-right-radius: 15px;
            position: fixed;
            top: 0;
            width: calc(100% - 40px);
            z-index: 10;
        }
        .profile {
            display: flex;
            align-items: center;
            text-decoration: none;
        }
        .profile_avatar img {
            border-radius: 50%;
            width: 45px;
            height: 45px;
            margin-right: 10px;
        }
        .profile_detail {
            align-items: center; /* Центрируем элементы по вертикали */
        }
        .profile_namebox{
            display: flex;
            color: var(--tg-theme-text-color);
        }
        .profile_name {
            color: var(--tg-theme-text-color);
            font-weight: bold;
            margin-bottom: 0;
        }

        label {
            display: inline-block;
            background: #424242;
            color: var(--tg-theme-text-color);
            padding: 5px 10px;
            border-radius: 20px;
            margin-bottom: 10px;
            font-weight: bold;
        }

        input[type="text"], input[type="number"] {
            width: calc(100% - 40px); /* Учитывая отступы */
            display: block;
            padding-left: 20px;
            padding-right: 20px;
            margin-bottom: 15px;
            border-radius: 15px;
            border: 1px solid #ccc; /* Легкая граница для видимости */
            background-color: var(--tg-theme-bg-color);
            color: var(--tg-theme-text-color);
            font-size: 16px;
            box-sizing: border-box;
        }

        input[type=radio] + label {
            padding: 5px 15px;
            border-radius: 20px;
            background:  var(--tg-theme-bg-color);
            color: var(--tg-theme-text-color);
            width: 45px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        input[type=radio]:checked + label {
            background-color: #03aac7; /* Цвет фона при выборе */
        }

        .radio-option {
            margin-bottom: 10px;
        }

        .form-group {
            margin-bottom: 10px;
        }

        select {
            width: calc(100% - 40px); /* Учитывая отступы по 20px с каждой стороны */
            padding: 8px; /* Увеличиваем отступы для удобства использования */
            font-size: 16px;
            border-radius: 15px; /* Скругленные углы */
            border: 1px; /* Граница для четкости */
            appearance: none; /* Убираем стандартные стили select в некоторых браузерах */
            -webkit-appearance: none;
            -moz-appearance: none;
            background-color: var(--tg-theme-bg-color);
            color: var(--tg-theme-text-color);
            cursor: pointer; /* Курсор в виде руки для указания на интерактивность */
            background-position: right 15px bottom 15px;
            background-size: 10px;
        }
        /* Стили для стрелки выпадающего списка в Firefox */
        @-moz-document url-prefix() {
            select {
                padding-right: 30px;

                background-size: 10px;
            }
        }
        /* Стили для стрелки выпадающего списка в остальных браузерах */
        select::-ms-expand {
            display: none; /* Убираем стандартную стрелку в IE/Edge */
        }

        .buttons {
            margin: 10px 0;
        }

        .add-button, .remove-button {
            border: none;
            border-radius: 50%;
            width: 23px;
            height: 23px;
            font-size: 16px;
            color: white;
            cursor: pointer;
            align-items: center;
            justify-content: center;
            padding: 0; /* Удалите любые стандартные отступы */
        }

        input[type=radio] {
            display: none;
        }

        .add-button {
            background-color: lightgreen;
        }

        .remove-button {
            background-color: lightcoral;
        }

        #entryPricesContainer, #takeProfitsContainer {
            margin-top: 10px;
        }

        #entryPricesContainer input, #takeProfitsContainer input {
            display: block;
            width: calc(100% - 20px); /* Учитывая отступы */
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="scrollable_content">
        <header>
            <a class="profile">
                <div class="profile_avatar">
                    <img src="https://play-lh.googleusercontent.com/8LuyzmkLRILH6vVF7OBU8zf1-gLiWqUHINbiGLgWoXn7W48Mcr6wYcmGnS7YFfT24w" alt="profile_avatar">
                </div>
                <div class="profile_detail">
                    <div class="profile_namebox">
                        <div class="profile_name" id="profile_name"> </div>
                    </div>
                </div>
            </a>
        </header>
        <main>
            <form id="cryptoForm">
                <div class="form-group">
                    <label for="cryptoName">Name of the crypto:</label>
                    <select id="cryptoName">
                        <option value="btc">BTC</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="amountUSD">Amount of USD to buy:</label>
                    <input type="number" id="amountUSD" name="amountUSD">
                </div>

                <div class="form-group">
                    <label for="position">Position:</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="long" name="position" value="Long">
                            <label for="long">Long</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="short" name="position" value="Short" checked>
                            <label for="short">Short</label>
                        </div>
                    </div>
                </div>

                <div class="form-group" id="entryPricesGroup">
                    <label for="entryPrices">Entry Prices:</label>
                    <button class="add-button"  type="button" onclick="addEntryPrice()">+</button>
                    <button class="remove-button" type="button" onclick="removeEntryPrice()">-</button>
                    <div id="entryPricesContainer">
                        <input type="number" id="entryPrice1" name="entryPrices">
                    </div>
                </div>

                <div class="form-group">
                    <label for="leverage">Leverage:</label>
                    <input type="number" id="leverage" name="leverage" onchange="updateLiquidationPrice()">
                </div>

                <div class="form-group">
                    <label>Liquidation Price:</label>
                    <span id="liquidationPrice">---</span>
                </div>

                <div class="form-group">
                    <label for="marginType">Margin Type:</label>
                    <select id="marginType">
                        <option value="isolated">Isolated</option>
                        <option value="crossed">Crossed</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="stopLoss">Stop Loss:</label>
                    <input type="number" id="stopLoss" name="stopLoss">
                </div>

                <div class="form-group" id="takeProfitsGroup">
                    <label for="takeProfits">Take Profits:</label>
                    <button class="add-button"  type="button" onclick="addTakeProfit()">+</button>
                    <button class="remove-button" type="button" onclick="removeTakeProfit()">-</button>
                    <div id="takeProfitsContainer">
                        <input type="number" id="takeProfit1" name="takeProfits">
                    </div>
                </div>
            </form>
        </main>
    </div>
    <script>
        function addEntryPrice() {
            const container = document.getElementById('entryPricesContainer');
            const newId = container.children.length + 1;
            const input = document.createElement('input');
            input.id = 'entryPrice' + newId;
            input.name = 'entryPrices';
            input.type = 'number';
            container.appendChild(input);
            input.addEventListener('input', checkInputs);
        }

        function removeEntryPrice() {
            const container = document.getElementById('entryPricesContainer');
            if (container.children.length > 1) {
                container.removeChild(container.lastChild);
            }
            checkInputs();
        }

        function addTakeProfit() {
            const container = document.getElementById('takeProfitsContainer');
            const newId = container.children.length + 1;
            const input = document.createElement('input');
            input.id = 'takeProfit' + newId;
            input.name = 'takeProfits';
            input.type = 'number';
            container.appendChild(input);
            input.addEventListener('input', checkInputs);
        }

        function removeTakeProfit() {
            const container = document.getElementById('takeProfitsContainer');
            if (container.children.length > 1) {
                container.removeChild(container.lastChild);
            }
            checkInputs();
        }
        document.addEventListener("DOMContentLoaded", function() {
            let tg = window.Telegram.WebApp;
            document.getElementById("profile_name").innerText = `${tg.initDataUnsafe.user.first_name}`;
            const formElements = document.querySelectorAll("#cryptoForm input, #cryptoForm select");

            let cryptos = ['BTCUSDT_UMCBL', 'ETHUSDT_UMCBL', 'XRPUSDT_UMCBL', 'EOSUSDT_UMCBL', 'BCHUSDT_UMCBL', 'LTCUSDT_UMCBL', 'ADAUSDT_UMCBL', 'ETCUSDT_UMCBL', 'LINKUSDT_UMCBL', 'TRXUSDT_UMCBL', 'DOTUSDT_UMCBL', 'DOGEUSDT_UMCBL', 'SOLUSDT_UMCBL', 'MATICUSDT_UMCBL', 'BNBUSDT_UMCBL', 'UNIUSDT_UMCBL', 'ICPUSDT_UMCBL', 'AAVEUSDT_UMCBL', 'FILUSDT_UMCBL', 'XLMUSDT_UMCBL', 'ATOMUSDT_UMCBL', 'XTZUSDT_UMCBL', 'SUSHIUSDT_UMCBL', 'AXSUSDT_UMCBL', 'THETAUSDT_UMCBL', 'AVAXUSDT_UMCBL', 'DASHUSDT_UMCBL', 'SHIBUSDT_UMCBL', 'MANAUSDT_UMCBL', 'GALAUSDT_UMCBL', 'SANDUSDT_UMCBL', 'DYDXUSDT_UMCBL', 'CRVUSDT_UMCBL', 'NEARUSDT_UMCBL', 'EGLDUSDT_UMCBL', 'KSMUSDT_UMCBL', 'ARUSDT_UMCBL', 'FTMUSDT_UMCBL', 'PEOPLEUSDT_UMCBL', 'LRCUSDT_UMCBL', 'NEOUSDT_UMCBL', 'WAVESUSDT_UMCBL', 'ALGOUSDT_UMCBL', 'IOTAUSDT_UMCBL', 'ENJUSDT_UMCBL', 'GMTUSDT_UMCBL', 'ZILUSDT_UMCBL', 'IOSTUSDT_UMCBL', 'APEUSDT_UMCBL', 'RUNEUSDT_UMCBL', 'KNCUSDT_UMCBL', 'APTUSDT_UMCBL', 'CHZUSDT_UMCBL', 'XMRUSDT_UMCBL', 'ROSEUSDT_UMCBL', 'ZRXUSDT_UMCBL', 'KAVAUSDT_UMCBL', 'ENSUSDT_UMCBL', 'GALUSDT_UMCBL', 'AUDIOUSDT_UMCBL', 'SXPUSDT_UMCBL', 'C98USDT_UMCBL', 'OPUSDT_UMCBL', 'RSRUSDT_UMCBL', 'SNXUSDT_UMCBL', 'STORJUSDT_UMCBL', '1INCHUSDT_UMCBL', 'COMPUSDT_UMCBL', 'IMXUSDT_UMCBL', 'LUNA2USDT_UMCBL', 'FLOWUSDT_UMCBL', 'REEFUSDT_UMCBL', 'QTUMUSDT_UMCBL', 'API3USDT_UMCBL', 'MASKUSDT_UMCBL', 'WOOUSDT_UMCBL', 'GRTUSDT_UMCBL', 'BANDUSDT_UMCBL', 'STGUSDT_UMCBL', 'LUNCUSDT_UMCBL', 'ONEUSDT_UMCBL', 'JASMYUSDT_UMCBL', 'MKRUSDT_UMCBL', 'BATUSDT_UMCBL', 'MAGICUSDT_UMCBL', 'ALPHAUSDT_UMCBL', 'LDOUSDT_UMCBL', 'OCEANUSDT_UMCBL', 'CELOUSDT_UMCBL', 'BLURUSDT_UMCBL', 'MINAUSDT_UMCBL', 'COREUSDT_UMCBL', 'CFXUSDT_UMCBL', 'ASTRUSDT_UMCBL', 'AGIXUSDT_UMCBL', 'GMXUSDT_UMCBL', 'LINAUSDT_UMCBL', 'ANKRUSDT_UMCBL', 'ACHUSDT_UMCBL', 'FETUSDT_UMCBL', 'FXSUSDT_UMCBL', 'RNDRUSDT_UMCBL', 'HOOKUSDT_UMCBL', 'BNXUSDT_UMCBL', 'SSVUSDT_UMCBL', 'USDCUSDT_UMCBL', 'LQTYUSDT_UMCBL', 'STXUSDT_UMCBL', 'TRUUSDT_UMCBL', 'DUSKUSDT_UMCBL', 'HBARUSDT_UMCBL', 'INJUSDT_UMCBL', 'BELUSDT_UMCBL', 'COTIUSDT_UMCBL', 'VETUSDT_UMCBL', 'ARBUSDT_UMCBL', 'LOOKSUSDT_UMCBL', 'KLAYUSDT_UMCBL', 'FLMUSDT_UMCBL', 'OMGUSDT_UMCBL', 'RLCUSDT_UMCBL', 'CKBUSDT_UMCBL', 'IDUSDT_UMCBL', 'LITUSDT_UMCBL', 'JOEUSDT_UMCBL', 'TLMUSDT_UMCBL', 'HOTUSDT_UMCBL', 'CHRUSDT_UMCBL', 'RDNTUSDT_UMCBL', 'ICXUSDT_UMCBL', 'HFTUSDT_UMCBL', 'ONTUSDT_UMCBL', 'ZECUSDT_UMCBL', 'UNFIUSDT_UMCBL', 'NKNUSDT_UMCBL', 'ARPAUSDT_UMCBL', 'DARUSDT_UMCBL', 'SFPUSDT_UMCBL', 'SKLUSDT_UMCBL', 'RVNUSDT_UMCBL', 'CELRUSDT_UMCBL', 'FLOKIUSDT_UMCBL', 'SPELLUSDT_UMCBL', 'SUIUSDT_UMCBL', 'EDUUSDT_UMCBL', 'PEPEUSDT_UMCBL', 'IOTXUSDT_UMCBL', 'CTKUSDT_UMCBL', 'STMXUSDT_UMCBL', 'UMAUSDT_UMCBL', 'BSVUSDT_UMCBL', 'TONUSDT_UMCBL', 'GTCUSDT_UMCBL', 'DENTUSDT_UMCBL', 'ZENUSDT_UMCBL', 'ORDIUSDT_UMCBL', 'KEYUSDT_UMCBL', 'IDEXUSDT_UMCBL', 'SLPUSDT_UMCBL', 'COMBOUSDT_UMCBL', 'LEVERUSDT_UMCBL', 'RADUSDT_UMCBL', 'ANTUSDT_UMCBL', 'QNTUSDT_UMCBL', 'MAVUSDT_UMCBL', 'MDTUSDT_UMCBL', 'XVGUSDT_UMCBL', '1000XECUSDT_UMCBL', 'AGLDUSDT_UMCBL', 'WLDUSDT_UMCBL', 'PENDLEUSDT_UMCBL', 'ARKMUSDT_UMCBL', 'CVXUSDT_UMCBL', 'YGGUSDT_UMCBL', 'OGNUSDT_UMCBL', 'LPTUSDT_UMCBL', 'BNTUSDT_UMCBL', 'SEIUSDT_UMCBL', 'CYBERUSDT_UMCBL', 'BAKEUSDT_UMCBL', 'GLMRUSDT_UMCBL', 'LOOMUSDT_UMCBL', 'BIGTIMEUSDT_UMCBL', 'ORBSUSDT_UMCBL', 'WAXPUSDT_UMCBL', 'POLYXUSDT_UMCBL', 'TIAUSDT_UMCBL', 'TWTUSDT_UMCBL', 'MEMEUSDT_UMCBL', 'PYTHUSDT_UMCBL', 'JTOUSDT_UMCBL', '1000SATSUSDT_UMCBL', '1000RATSUSDT_UMCBL', 'ACEUSDT_UMCBL', 'XAIUSDT_UMCBL', 'MANTAUSDT_UMCBL'];

            let select = document.getElementById("cryptoName");

            cryptos.forEach(function(crypto) {
                let option = document.createElement("option");
                option.value = crypto;
                option.textContent = crypto;
                select.appendChild(option);
            });

            function checkInputs() {
                if (allInputsFilled()) {
                    MainButton.setParams({"color": buttonColor});
                    MainButton.enable();
                } else {
                    MainButton.setParams({"color": "#e5e5e5"});
                    MainButton.disable();
                }
            }

            formElements.forEach(element => {
                element.addEventListener('input', checkInputs);
            });

            function allInputsFilled() {
                // Проверка обычных полей и выпадающих списков
                const standardInputsFilled = Array.from(formElements).every(element => {
                    if (element.type !== "radio") {
                        return element.value.trim() !== '';
                    }
                    return true;
                });

                // Проверка радиокнопок
                const radioGroups = document.querySelectorAll(".radio-group");
                const radiosFilled = Array.from(radioGroups).every(group => {
                    const radios = group.querySelectorAll("input[type='radio']");
                    return Array.from(radios).some(radio => radio.checked);
                });

                // Проверка динамически добавленных полей
                const dynamicFieldsFilled = true; // Допустим, что эти поля заполнены корректно

                return standardInputsFilled && radiosFilled && dynamicFieldsFilled;
            }

            var MainButton = tg.MainButton;
            MainButton.text = "Start";
            MainButton.onClick(function() {
                window.location.href = "/";
            });

            checkInputs();

            let lastViewportHeight = tg.viewportHeight;
            function checkExpandedState() {
                if (tg.isExpanded) {
                    tg.MainButton.show();
                } else {
                    tg.MainButton.hide();
                }
            }

            function checkViewportHeightChange() {
                if (tg.viewportHeight !== lastViewportHeight) {
                    checkExpandedState();
                    lastViewportHeight = tg.viewportHeight;
                }
                requestAnimationFrame(checkViewportHeightChange);
            }
            checkExpandedState();
            checkViewportHeightChange();


            const dynamicFields = document.querySelectorAll("#entryPricesContainer input, #takeProfitsContainer input");
            dynamicFields.forEach(field => {
                field.addEventListener('input', checkInputs);
            });

            document.addEventListener('touchstart', function(e) {
            if (document.activeElement.tagName === 'INPUT' || document.activeElement.tagName === 'TEXTAREA') {
                if (!e.target.isEqualNode(document.activeElement)) {
                    document.activeElement.blur();
                }
            }
            }, false);

        });
    </script>
</body>
</html>
